# UML基础知识

> ==面向对象设计==主要就是使用UML的类图
> 类图用于描述系统中所包含的类以及它们之间的相互关系，帮助人们==简化对系统的理解==，
> 它是**系统分析和设计**阶段的重要产物，也是系统编码和测试的重要模型依据



> 类Class(类型之一) 封装了 函数成员和 数据成员; 
> 优秀设计过的类,一般是单一职责;





## UML画法

---

看到该图分为上中下三部分：上层是类名，中间层是属性（类的成员变量），下层是方法（类的成员函数）。

可见性：+ 表示public、# 表示protected、- 表示private、__(下划线)表示static

属性的表示方式：【可见性】【属性名称】:【类型】= { 缺省值，可选 }

方法的表示方式：【可见性】【方法名称】(【参数名 : 参数类型，……】）:【返回值类型】

如果我们定义的类是一个抽象类（类中有纯虚函数），在画UML类图的时候，类名需要使用斜体显示

> :warning: 在使用UML画类图的时候，虚函数的表示方跟随类名，也就是使用斜体，如果是纯虚函数则需要在最后给函数指定=0。



## 类与类之间的关系

---

### 继承

> **继承**也叫作泛化（Generalization），用于描述父子类之间的关系
> 泛化关系用带空心三角形的实线来表示
> 有空心三角的一端指向父类，另一端连接子类

* 普通继承关系
* 抽象继承关系

### 关联关系

---

> 关联（Assocition）关系是类与类之间最常见的一种关系，它是一种结构化的关系，表示一个对象与另一个对象之间有联系.如汽车和轮胎、师傅和徒弟、班级和学生等
> 用（带接头或不带箭头的）实线连接有关联关系
> 通常将一个类的对象作为另一个类的**成员变量**

* 单向关联指的是关联只有一个方向.
  使用的连接线是带单向箭头的实线, 哪个类作为了当前类的成员变量，那么箭头就指向哪个类
* 双向关联一般使用没有箭头的实线来连接有双向关联关系的两个类，这两个类的对象分别作为了对方类的成员变量
  有些UML绘图软件使用的是带双向箭头的实线来表示双向关联关系
* 自关联指的就是当前类中包含一个自身类型的对象成员，这在链表中非常常见
  一般使用带箭头的实线来描述自关联关系



### 聚合关系

---

聚合（Aggregation）关系表示整体与部分的关系。在聚合关系中，成员对象是整体的一部分，但是成员对象可以脱离整体对象独立存在。
在UML中，聚合关系用带空心菱形的直线表示

> 代码实现聚合关系，**成员对象**通常以构造方法、Setter方法的方式注入到整体对象之中，因为==成员对象可以脱离整体对象独立存在==。
>
> 表示聚合关系的线，**有空心菱形的一端指向整体对象**，另一端连接局部对象（有些UML绘图软件在这一端还带一个箭头）。
>

```C++
class Plant
{
    // 植物
};

class Animal
{
    // 动物
};

class Water
{
    // 水
};

class Sunshine
{
    // 阳光
};

class Forest
{
public:
    Forest(Plant p, Animal a, Water w, Sunshine s) : 
        m_plant(p),m_animal(a),m_water(w),m_sun(s)
    {
    }
private:
    Plant m_plant;
    Animal m_animal;
    Water m_water;
    Sunshine m_sun;
};

```



### 组合关系

---

组合（Composition）关系也表示的是一种整体和部分的关系，但是在组合关系中整体对象可以控制成员对象的生命周期，一旦整体对象不存在，成员对象也不存在，整体对象和成员对象之间具有同生共死的关系

> 在UML中组合关系用带实心菱形的直线表示

> 代码实现组合关系，通常在==整体类的构造方法中直接实例化成员类==，因为组合关系的整体和部分是共生关系，整体的实例对象被析构的时候它的子对象也会一并被析构。如果通过外部注入，即使整体不存在了，部分还是存在的，这样的话就变成聚合关系了
>

```c++
class Root
{
};

class Trunk
{
};

class Branch
{
};

class Leaf
{
};

class Tree
{
public:
    Tree()
    {
        m_root = new Root;
        m_trunk = new Trunk;
        m_branch = new Branch;
        m_leaf = new Leaf;
    }
    ~Tree()
    {
        delete m_root;
        delete m_trunk;
        delete m_branch;
        delete m_leaf;
    }
private:
    Root* m_root;
    Trunk* m_trunk;
    Branch* m_branch;
    Leaf* m_leaf;
};
```



### 依赖关系

---

依赖（Dependency）关系是一种使用关系，特定事物的改变有可能会影响到使用该事物的其他事物，在需要表示一个事物使用另一个事物时使用依赖关系，大多数情况下依赖关系体现在某个类的方法使用另一个类的对象作为参数。

>  在UML中，依赖关系用带箭头的虚线表示，由依赖的一方指向被依赖的一方

依赖关系通常通过三种方式来实现：

将一个类的对象作为另一个类中方法的参数

在一个类的方法中将另一个类的对象作为其对象的局部变量

在一个类的方法中调用另一个类的静态方法

类之间的关系强弱顺序是这样的：继承（泛化） >  组合  >  聚合  >  关联  >  依赖





### 关联关系、聚合关系、组合关系之间的区别

从上文可以看出，关联关系、聚合关系和组合关系三者之间比较相似，最后就来总结一下这三者之间的区别：

关联和聚合的区别主要在于语义上：关联的两个对象之间一般是平等的，聚合则一般是不平等的。

聚合和组合的区别则在语义和实现上都有差别：

组合的两个对象之间生命周期有很大的关联，被组合的对象在组合对象创建的同时或者创建之后创建在组合对象销毁之前销毁，聚合则无需考虑这些事情。
一般来说被组合对象不能脱离组合对象独立存在，而且也只能属于一个组合对象，聚合则不一样，被聚合的对象可以属于多个聚合对象。
最后，再举例子来描述一下这三种关系：

朋友之间属于关联关系，因为这种关系是平等的，关联关系只是用于表示两个对象之间的一种简单的联系而已。
图书馆看书的时候，人和书属于聚合关系。书是可以独立存在的，而且书不仅可以属于自己，也可以属于别人。
人和自己的心脏属于组合关系，因为心脏不能脱离人体而独自存在


